<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Docker en este proyecto</title>
    <style>
        :root {
            --bg: #0f1115;
            --card: #15181f;
            --accent: #48c9b0;
            --text: #f3f4f6;
            --muted: #9aa1b8;
            --success: #10b981;
            --warning: #f59e0b;
        }
        * { box-sizing:border-box; }
        body {
            margin:0;
            font-family: "Inter", "Segoe UI", system-ui, sans-serif;
            background: radial-gradient(circle at 10% -10%, rgba(72,201,176,0.25), transparent 45%), #0f1115;
            color: var(--text);
            min-height:100vh;
        }
        header {
            padding:3rem 1.5rem 2rem;
            text-align:center;
        }
        header h1 {
            margin:0;
            font-size:clamp(2rem,4vw,3rem);
        }
        header p {
            margin:0.75rem auto;
            max-width:45rem;
            color:var(--muted);
        }
        main {
            max-width:960px;
            margin:0 auto 3rem;
            padding:0 1.5rem;
        }
        section {
            margin-top:2rem;
        }
        .grid {
            display:grid;
            gap:1rem;
        }
        .grid-2 {
            grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
        }
        .card {
            background:var(--card);
            padding:1.25rem;
            border-radius:1rem;
            border:1px solid rgba(255,255,255,0.08);
            box-shadow:0 20px 45px rgba(0,0,0,0.35);
        }
        .card h3 {
            margin-top:0;
            color:var(--accent);
        }
        .card h4 {
            margin-top:1rem;
            color:var(--accent);
            font-size:1rem;
        }
        .code-block {
            background:rgba(0,0,0,0.3);
            padding:1rem;
            border-radius:0.5rem;
            border-left:2px solid var(--accent);
            overflow-x:auto;
            margin:0.75rem 0;
            font-family: "JetBrains Mono", monospace;
            font-size:0.9rem;
            color:#a1e8dd;
        }
        .step-list {
            list-style:none;
            padding:0;
            margin:0;
        }
        .step-list li {
            padding:0.75rem 0 0.75rem 1.5rem;
            border-bottom:1px solid rgba(255,255,255,0.06);
            position:relative;
        }
        .step-list li:before {
            content:attr(data-step);
            position:absolute;
            left:0;
            top:0.75rem;
            width:1.25rem;
            height:1.25rem;
            background:var(--accent);
            color:var(--bg);
            border-radius:50%;
            display:flex;
            align-items:center;
            justify-content:center;
            font-size:0.8rem;
            font-weight:600;
        }
        .step-list li:last-child { border-bottom:none; }
        .tag {
            display:inline-flex;
            align-items:center;
            gap:0.35rem;
            background:rgba(72,201,176,0.15);
            color:var(--accent);
            padding:0.25rem 0.65rem;
            border-radius:999px;
            font-size:0.8rem;
            font-weight:600;
        }
        .note {
            background:rgba(245,158,11,0.1);
            border-left:2px solid var(--warning);
            padding:1rem;
            border-radius:0.5rem;
            margin:1rem 0;
            color:var(--text);
        }
        .note strong {
            color:var(--warning);
        }
        code {
            background:rgba(72,201,176,0.1);
            color:var(--accent);
            padding:0.2rem 0.4rem;
            border-radius:0.3rem;
            font-family: "JetBrains Mono", monospace;
            font-size:0.9em;
        }
        footer {
            text-align:center;
            margin-top:3rem;
            color:var(--muted);
            font-size:0.9rem;
        }
        .flow-diagram {
            background:rgba(0,0,0,0.3);
            padding:1.5rem;
            border-radius:1rem;
            border:1px solid rgba(72,201,176,0.2);
            margin:1rem 0;
            text-align:center;
            font-family: monospace;
            font-size:0.9rem;
            white-space:pre-wrap;
            word-break:break-word;
        }
    </style>
</head>
<body>
    <header>
        <div class="tag">üê≥ Docker ¬∑ Contenedores</div>
        <h1>Docker en este proyecto</h1>
        <p>Gu√≠a completa para construir, etiquetar y desplegar la aplicaci√≥n en Google Cloud Run usando Docker.</p>
    </header>
    <main>
        <!-- Introducci√≥n -->
        <section>
            <div class="card">
                <h3>¬øQu√© hace Docker aqu√≠?</h3>
                <p>Docker encapsula tu aplicaci√≥n Spring Boot en un contenedor consistente que funciona igual en cualquier m√°quina. Con este proyecto:</p>
                <ul>
                    <li>Se construye una imagen desde el <code>Dockerfile</code>.</li>
                    <li>Se sube a <strong>Google Artifact Registry</strong> (repositorio de contenedores).</li>
                    <li>Se despliega autom√°ticamente a <strong>Google Cloud Run</strong>.</li>
                </ul>
                <p>El flujo es: Local ‚Üí Artifact Registry ‚Üí Cloud Run (ejecut√°ndose en la nube).</p>
            </div>
        </section>

        <!-- Requisitos -->
        <section class="grid grid-2">
            <div class="card">
                <h3>Requisitos previos</h3>
                <ul>
                    <li><strong>Docker</strong> instalado en tu m√°quina.</li>
                    <li><strong>Google Cloud SDK</strong> (<code>gcloud</code>).</li>
                    <li>Una cuenta Google Cloud con proyecto activo.</li>
                    <li>Conocer tu <code>PROJECT_ID</code> de Google Cloud.</li>
                </ul>
                <div class="note">
                    <strong>üí° Tip:</strong> Ejecuta <code>gcloud config list</code> para ver tu configuraci√≥n actual.
                </div>
            </div>
            <div class="card">
                <h3>Configuraci√≥n inicial (una sola vez)</h3>
                <p>Ejecutar estos comandos para autenticarse y configurar tu proyecto:</p>
                <div class="code-block">gcloud auth login
gcloud auth application-default login

gcloud config set project TU_PROJECT_ID
gcloud config set run/region europe-southwest1</div>
                <p style="font-size:0.9rem;color:var(--muted);">Reemplaza <code>TU_PROJECT_ID</code> con tu ID real.</p>
            </div>
        </section>

        <!-- Flujo de trabajo -->
        <section>
            <div class="card">
                <h3>Flujo de trabajo: Del c√≥digo al Cloud</h3>
                <div class="flow-diagram">‚îå‚îÄ Local: mvn clean package
‚îÇ
‚îú‚îÄ Construir imagen: docker build
‚îÇ
‚îú‚îÄ Etiquetar imagen: docker tag
‚îÇ
‚îú‚îÄ Subir a Artifact Registry: docker push
‚îÇ
‚îî‚îÄ Desplegar en Cloud Run: gcloud run deploy</div>
            </div>
        </section>

        <!-- Pasos detallados -->
        <section>
            <div class="card">
                <h3>Paso 1: Crear el repositorio en Artifact Registry</h3>
                <p style="color:var(--muted);margin-top:0;">Se hace solo la primera vez para crear el repositorio Docker en tu proyecto Google Cloud.</p>
                <div class="code-block">gcloud artifacts repositories create web-examen-repo \
  --repository-format=docker \
  --location=europe-southwest1 \
  --description="Repo del examen"</div>
                <div class="note">
                    <strong>En Windows:</strong> Si la consola no acepta <code>\</code>, escribe todo en una l√≠nea:
                    <div class="code-block">gcloud artifacts repositories create web-examen-repo --repository-format=docker --location=europe-southwest1 --description="Repo del examen"</div>
                </div>
            </div>
        </section>

        <section>
            <div class="card">
                <h3>Paso 2: Configurar Docker para Artifact Registry</h3>
                <p style="color:var(--muted);margin-top:0;">Se ejecuta una vez por m√°quina para autorizar Docker a subir im√°genes.</p>
                <div class="code-block">gcloud auth configure-docker europe-southwest1-docker.pkg.dev</div>
            </div>
        </section>

        <section>
            <div class="card">
                <h3>Paso 3: Construir la imagen Docker localmente</h3>
                <p style="color:var(--muted);margin-top:0;">Desde la carpeta ra√≠z del proyecto (donde est√° el <code>Dockerfile</code>):</p>
                <div class="code-block">docker build -t web-examen .</div>
                <p style="font-size:0.9rem;color:var(--muted);margin:0.5rem 0 0;">Esto lee el <code>Dockerfile</code> y construye la imagen local con etiqueta <code>web-examen</code>.</p>
            </div>
        </section>

        <section>
            <div class="card">
                <h3>Paso 4: Etiquetar y subir a Artifact Registry</h3>
                <p style="color:var(--muted);margin-top:0;">Etiqueta la imagen local con la ruta del repositorio en Google Cloud:</p>
                <div class="code-block">docker tag web-examen europe-southwest1-docker.pkg.dev/TU_PROJECT_ID/web-examen-repo/web-examen:latest

docker push europe-southwest1-docker.pkg.dev/TU_PROJECT_ID/web-examen-repo/web-examen:latest</div>
                <p style="font-size:0.9rem;color:var(--muted);margin:0.5rem 0 0;">Reemplaza <code>TU_PROJECT_ID</code> con tu ID real. El <code>push</code> sube la imagen a Google Cloud.</p>
            </div>
        </section>

        <section>
            <div class="card">
                <h3>Paso 5: Desplegar en Google Cloud Run</h3>
                <p style="color:var(--muted);margin-top:0;">Ejecuta en Windows en una sola l√≠nea:</p>
                <div class="code-block">gcloud run deploy web-examen --image=europe-southwest1-docker.pkg.dev/TU_PROJECT_ID/web-examen-repo/web-examen:latest --platform=managed --region=europe-southwest1 --allow-unauthenticated --port=8080 --memory=512Mi --cpu=1</div>
                <p style="font-size:0.9rem;color:var(--muted);margin:0.5rem 0 0;">Esto crea o actualiza un servicio en Cloud Run. Al completar, mostrar√° una URL p√∫blica para acceder a tu aplicaci√≥n.</p>
            </div>
        </section>

        <!-- Opciones de despliegue -->
        <section class="grid grid-2">
            <div class="card">
                <h3>Opciones principales de deploy</h3>
                <ul>
                    <li><code>--memory=512Mi</code> ‚Üí Memoria RAM (512MB).</li>
                    <li><code>--cpu=1</code> ‚Üí CPUs asignadas (1 vCPU).</li>
                    <li><code>--port=8080</code> ‚Üí Puerto donde escucha la app.</li>
                    <li><code>--allow-unauthenticated</code> ‚Üí Acceso p√∫blico sin auth.</li>
                </ul>
                <div class="note">
                    <strong>üìä Ajusta seg√∫n necesidad:</strong> M√°s memoria/CPU = mayor costo pero mejor rendimiento.
                </div>
            </div>
            <div class="card">
                <h3>Verificar el despliegue</h3>
                <p>Una vez desplegado, puedes:</p>
                <div class="code-block">gcloud run services list
gcloud run services describe web-examen</div>
                <p>Para ver logs en tiempo real:</p>
                <div class="code-block">gcloud run logs read web-examen --limit=50</div>
            </div>
        </section>

        <!-- Checklist r√°pido -->
        <section>
            <div class="card">
                <h3>Checklist: Desplegar en 5 minutos</h3>
                <ol class="step-list">
                    <li data-step="1"><strong>Autenticar:</strong> <code>gcloud auth login</code></li>
                    <li data-step="2"><strong>Configurar regi√≥n:</strong> <code>gcloud config set run/region europe-southwest1</code></li>
                    <li data-step="3"><strong>Construir:</strong> <code>docker build -t web-examen .</code></li>
                    <li data-step="4"><strong>Etiquetar:</strong> <code>docker tag web-examen europe-southwest1-docker.pkg.dev/PROJECT_ID/web-examen-repo/web-examen:latest</code></li>
                    <li data-step="5"><strong>Subir:</strong> <code>docker push europe-southwest1-docker.pkg.dev/PROJECT_ID/web-examen-repo/web-examen:latest</code></li>
                    <li data-step="6"><strong>Desplegar:</strong> <code>gcloud run deploy web-examen --image=... (comando completo arriba)</code></li>
                </ol>
            </div>
        </section>

        <!-- Tips -->
        <section class="grid grid-2">
            <div class="card">
                <h3>üö® Errores comunes</h3>
                <ul>
                    <li><strong>Error de auth:</strong> Ejecuta <code>gcloud auth configure-docker</code></li>
                    <li><strong>Imagen no encontrada:</strong> Verifica que el nombre coincida exactamente (PROJECT_ID, regi√≥n, nombre repo).</li>
                    <li><strong>Timeout al construir:</strong> Docker puede tardar; espera o aumenta el timeout.</li>
                    <li><strong>Cloud Run sin conectar:</strong> Verifica que la app escuche en puerto <code>8080</code>.</li>
                </ul>
            </div>
            <div class="card">
                <h3>üí° Consejos profesionales</h3>
                <ul>
                    <li>Usa <code>:latest</code> solo en desarrollo. En prod, especifica versiones (<code>:v1.0.0</code>).</li>
                    <li>Crea variables de entorno en Cloud Run, no las hard-codees en la imagen.</li>
                    <li>Revisa los logs con <code>gcloud run logs</code> despu√©s de desplegar.</li>
                    <li>Cloud Run solo cobra mientras procesa solicitudes (serverless).</li>
                </ul>
            </div>
        </section>

    </main>
    <footer>
        Docker y Google Cloud Run permiten desplegar y escalar tu aplicaci√≥n sin administrar servidores.
    </footer>
</body>
</html>
